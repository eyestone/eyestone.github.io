<!DOCTYPE html>
<html class="no-js" lang="en-us" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="description" content="项目文档库">
    <meta name="author" content="">

    <meta name="keyword" content="">
    <link rel="shortcut icon" href="/favicon.ico">

    <title>项目文档库</title>

   	
    
        <link rel="stylesheet" href="http://eyestone.github.io/css/theme/flatly.css">
    

    <link rel="stylesheet" href="http://eyestone.github.io/css/font-awesome.min.css">

   	
   	<link rel="stylesheet" href="http://eyestone.github.io/css/style.css">


    
    <script src="http://eyestone.github.io/js/jquery.min-2.1.4.js"></script>
    <script src="http://eyestone.github.io/js/bootstrap.min-3.3.5.js"></script>
    <script src="http://cdn.bootcss.com/highlight.js/9.0.0/highlight.min.js"></script>
    <link href="http://cdn.bootcss.com/highlight.js/9.0.0/styles/default.min.css" rel="stylesheet">
    <script>hljs.initHighlightingOnLoad();</script>
    
    <link href="http://eyestone.github.io/index.xml" rel="alternate" type="application/rss+xml" title="项目文档库" />
</head>
<body lang="en">
    
    <div class="container">
    <div class="row">
        <div class="navbar navbar-default navbar-inverse" role="navigation">
            <div class="navbar-header">
                <a class="navbar-brand" href="http://eyestone.github.io">项目文档库</a>
            </div>
            <div class="navbar-collapse collapse navbar-responsive-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="http://eyestone.github.io">首页</a></li>
                    <li><a href="http://eyestone.github.io/post/">文章</a></li>
                    <li><a href="http://eyestone.github.io/life/">生活</a></li>
                    
                </ul>
            </div>
        </div>
    </div>
</div>



    <div class="container">
        
        
            	
		
			<div class="row">
				
				<div class="col-md-offset-1 col-md-10">
					<h3><a href="http://eyestone.github.io/post/todo-list/">任务列表</a></h3>
						<small><span class="label label-primary">
							
								Wed, Jun 22, 2016
							</span>&nbsp;in
							
								
								<a href="/categories/%E4%BB%BB%E5%8A%A1">任务</a>
							 using tags
							
								
							<a href="/tags/%E4%BB%BB%E5%8A%A1">任务</a>
						
					</small>
				</div>
			</div>
			<div class="row">
				<div class="col-md-offset-1 col-md-10">
					<br>
					
						

<h3 id="方法:84ed0d057c566f207df07d4dbf3355b4"><strong>方法</strong></h3>

<ul>
<li>1.每天查看ui、后台、管理端web、android、ios版本进度，记录问题</li>
<li>2.对任务进行分类，重要任务和前置任务先完成</li>
<li>3.对任务进行分解，整理依赖关系</li>
<li>4.讨论订立时间表，按节奏推进</li>
<li>5.个人自己管理还是统一管理任务进度？</li>
</ul>

<h3 id="方案:84ed0d057c566f207df07d4dbf3355b4"><strong>方案</strong></h3>

<ul>
<li><p>将汇总的任务列表上传到github博客，通知到所有人。相关人员查看到博客之后，从博客中摘出任务，创建issue，创建方式参见说明。任务执行完成之后由相关人员关闭issue。</p></li>

<li><p>原则：尽量不加班</p></li>
</ul>

<hr />

<h3 id="汇总:84ed0d057c566f207df07d4dbf3355b4"><strong>汇总:</strong></h3>

<ul>
<li>1.效果图需要和app对一遍，此任务放后，待功能实现完成</li>
</ul>

<hr />

<h3 id="ui:84ed0d057c566f207df07d4dbf3355b4"><strong>ui：</strong>：</h3>

<h5 id="待改:84ed0d057c566f207df07d4dbf3355b4"><strong>待改：</strong></h5>

<ul>
<li>1.修改手势密码，改为先验证手势密码，然后设置新的 &ndash; <em>done</em></li>
<li>2.试算页面不够活泼 &ndash; <em>done</em></li>
<li>3.我的账单部分分收入和支出 &ndash; <em>done</em></li>
<li>4.我的订单：&ndash; <em>done</em></li>
<li>5.修改升档部分的设计 &ndash; <em>done</em></li>
<li>6.申请记录修改为只显示企业团险和交通意外险两大类，可删除，点进去可修改 &ndash; <em>done</em></li>
<li>7.调整android界面，一些图片的大小 &ndash; <em>ing</em></li>
</ul>

<h4 id="未做:84ed0d057c566f207df07d4dbf3355b4"><strong>未做：</strong></h4>

<ul>
<li>1.付款成功页面未做 &ndash; <em>done</em></li>
<li>2.购物车添加下箭头，可以点开进行修改 &ndash; <em>done</em></li>
<li>3.我的活动 &ndash; <em>done</em></li>
<li>4.心愿单 &ndash; <em>done</em></li>
<li>5.我的特权</li>
<li>6.商品订单评论页面</li>
</ul>

<hr />

<h3 id="后台:84ed0d057c566f207df07d4dbf3355b4"><strong>后台：</strong></h3>

<ul>
<li>配合管理端web和前端任务做具体的设置</li>
</ul>

<h4 id="待改-1:84ed0d057c566f207df07d4dbf3355b4"><strong>待改：</strong></h4>

<ul>
<li>1.读取所有保险详情列表解析问题  &ndash;  <em>done</em></li>
<li>2.测试所有保险相关接口 &ndash; <em>done : 暂时没有发现问题，随时有问题随时响应</em></li>
<li>3.设计和实现升档部分接口：需要增加一个获取历史信息的接口  &ndash;  <em>done</em></li>
<li>4.用户使用邀请码验证通过后应该关联公司和用户  &ndash;  <em>done</em></li>
<li>5.添加关于试算修改的讨论记录—&gt;添加两个接口：修改和删除  &mdash;  <em>done</em></li>
<li>6.数据库表中的保险申请，添加一个type字段，标明是试算的还是升档的  &ndash;  <em>done</em></li>
<li>7.写福米兑换场讨论结果文档，包括整个流程 &ndash; <em>done</em></li>
<li>8.写签证部分文档</li>
<li>9.写福米兑换场相关的接口文档到showdoc &ndash; <em>done</em></li>
<li>10.保险订单需要加入ticket，优先级高 &ndash; <em>done : 不放入ticket，用专门的接口获取</em></li>
<li>11.心愿单接口没有数据</li>
<li>12.福米查询接口没有</li>
<li>13.代码框架整理 &ndash; <em>ing</em></li>
<li>14.对于订单部分的处理，整理需要通知客服的情况，写通知</li>
</ul>

<h4 id="未做-1:84ed0d057c566f207df07d4dbf3355b4"><strong>未做：</strong></h4>

<ul>
<li>1.福米兑换场 &ndash; <em>ing</em>

<ul>
<li>1.1.梳理福米兑换场业务逻辑 &ndash; <em>ing</em></li>
<li>1.2.梳理福米兑换场部分的代码 &ndash; <em>done</em></li>
<li>1.3.实现底层代码：将福米支付写到anypay，实现dao，实现service，重写LaifuPay类 &ndash; <em>done</em></li>
<li>1.4.实现controller &ndash; <em>done</em></li>
<li>1.5.添加一个获取邮费信息接口，目前两种方式，普邮10块，顺丰23块。 &ndash; <em>done</em></li>
</ul></li>
<li>2.签证：暂时没有资源</li>
<li>3.查看阿里支付的文档，确认退款流程 &ndash; <em>done : 可以进行部分退款</em></li>
<li>4.实现评论功能：&ndash; <em>done</em>

<ul>
<li>4.1整理评论功能逻辑 &ndash; <em>done</em></li>
<li>4.2添加数据库中的评论表 &ndash; <em>done</em></li>
<li>4.3写发表评论接口 &ndash; <em>done</em></li>
<li>4.4写查询评论接口，包括按照产品查 &ndash; <em>done</em></li>
</ul></li>
<li>5.写支付接口

<ul>
<li>5.1整合支付功能到LaifuPay</li>
<li>5.2写福米支付函数 &ndash; <em>done</em></li>
<li>5.3重写支付回调函数，包括成功和失败</li>
<li>5.4写充值接口，包括微信和支付宝，同时要完成通知回调函数</li>
</ul></li>
<li>6.写购物车接口 &ndash; <em>done</em>

<ul>
<li>6.1加入购物车 &ndash; <em>done</em></li>
<li>6.2查询购物车 &ndash; <em>done</em></li>
<li>6.3删除购物车 &ndash; <em>done</em></li>
<li>6.4修改购物车 &ndash; <em>done</em></li>
</ul></li>
<li>7.写收货地址接口 &ndash; <em>done</em>

<ul>
<li>7.1添加收货地址 &ndash; <em>done</em></li>
<li>7.2修改收货地址 &ndash; <em>done</em></li>
<li>7.3删除收货地址 &ndash; <em>done</em></li>
<li>7.4设置默认的收货地址 &ndash; <em>done</em></li>
</ul></li>
<li>8.写订单接口 &ndash; <em>done</em>

<ul>
<li>8.1从购物车生成订单 &ndash; <em>done</em></li>
<li>8.2直接生成订单 &ndash; <em>done</em></li>
<li>8.3取消订单 &ndash; <em>done</em></li>
<li>8.4修改订单 &ndash; <em>done</em></li>
<li>8.5删除订单接口,逻辑删除 &ndash; <em>done</em></li>
<li>8.6获取订单接口,取消的和删除订单不在客户端显示 &ndash; <em>done</em></li>
</ul></li>
</ul>

<hr />

<h3 id="管理端web:84ed0d057c566f207df07d4dbf3355b4"><strong>管理端web：</strong></h3>

<ul>
<li>1.熟悉angular框架 &ndash; <em>done</em></li>
<li>2.整理缺失的表单逻辑 &ndash; <em>ing</em></li>
<li>3.写ajax参数跨域转换函数 &ndash; <em>done</em></li>
</ul>

<h4 id="待改-2:84ed0d057c566f207df07d4dbf3355b4"><strong>待改：</strong></h4>

<ul>
<li>1.测试服务器上传图片问题修改 &ndash; <em>done</em></li>
<li>2.商品修改不成功问题 &ndash; <em>done</em></li>
<li>3.新增奖券图片录入功能 &ndash; <em>done</em></li>
<li>4.调整root权限下图片预览不完整问题 &ndash; <em>done</em></li>
</ul>

<h4 id="未做-2:84ed0d057c566f207df07d4dbf3355b4"><strong>未做：</strong></h4>

<ul>
<li>1.保险理赔信息管理</li>
<li>2.保险申请信息管理</li>
<li>3.保险档案管理</li>
<li>4.订单管理</li>
<li>5.用户反馈管理</li>
<li>6.运维人员管理</li>
<li>7.其他：具体需求具体讨论</li>
</ul>

<hr />

<h3 id="android:84ed0d057c566f207df07d4dbf3355b4"><strong>android：</strong></h3>

<h4 id="待改-3:84ed0d057c566f207df07d4dbf3355b4"><strong>待改：</strong></h4>

<ul>
<li>1.登陆：输入密码确定以后先崩溃然后进入app</li>
<li>2.活动分享：未完成</li>
<li>3.租房详情：去掉more按钮</li>
<li>4.关于来福：修改和ios一致</li>
<li>5.修改手机号：验证身份证，提示邮箱不符合规范</li>
<li>6.个人信息右边的编辑图标删除</li>
<li>7.反馈：放到个人信息页</li>
<li>8.账户余额:修改和效果图一致</li>
<li>9.试算页面：添加一人后，不能修改信息 &ndash; <em>确定不让修改</em></li>
<li>10.升档页面跟进设计稿修改 &ndash; <em>done</em></li>
<li>11.邀请码验证页面修改为验证手机号和邀请码</li>
</ul>

<h4 id="未做-3:84ed0d057c566f207df07d4dbf3355b4"><strong>未做：</strong></h4>

<ul>
<li>1.福米兑换场</li>
<li>2.去评分：未做</li>
<li>3.我的福利：保险，确定是不是因为没有数据导致</li>
<li>4.我的保障：交通意外险 &ndash; <em>done</em></li>
<li>5.福享汇：福米兑换场</li>
<li>6.我的保障：申请记录列表，删除功能 &ndash; <em>done</em></li>
<li>7.我的保障：申请记录修改，使用试算页面逻辑(约两天时间) &ndash; <em>ing</em></li>
<li>8.福米兑换场首页功能实现 &ndash; <em>目前需求不是很明确，要明确一下</em></li>
<li>9.商品展示：商品列表和商品详情 &ndash; *ing : 有问题 android:两天  *</li>
<li>10.购物车

<ul>
<li>10.1加入购物车</li>
<li>10.2加载购物车</li>
<li>10.3修改购物车</li>
<li>10.4删除购物车中的商品</li>
</ul></li>
<li>11.订单

<ul>
<li>11.1从购物车生成订单</li>
<li>11.2直接从商品生成订单</li>
<li>11.3订单加载</li>
<li>11.4订单修改</li>
<li>11.5取消订单</li>
</ul></li>
<li>12.评论

<ul>
<li>12.1发表评论</li>
<li>12.2查询评论</li>
</ul></li>
<li>13.支付（目前还没有考虑清楚，所以暂时这样分类）

<ul>
<li>13.1微信支付</li>
<li>13.2阿里支付</li>
<li>13.3福米支付</li>
</ul></li>
</ul>

<hr />

<h3 id="ios:84ed0d057c566f207df07d4dbf3355b4"><strong>ios：</strong></h3>

<h4 id="待改-4:84ed0d057c566f207df07d4dbf3355b4"><strong>待改：</strong></h4>

<ul>
<li>1.活动—活动报名页：时间图标应该和时间一起隐藏</li>
<li>2.账号设置：右面编辑图标删掉</li>
<li>3.账号设置：安全设置可以修改的条目应该给一个右箭头</li>
<li>4.重置登陆密码页面：修改和android一致</li>
<li>5.关于来福页面：字体颜色有问题</li>
<li>6.我的福利页面修改和效果图保持一致</li>
<li>7.账户余额页面照效果图修改</li>
<li>8.企业团险详情页面：字体居中</li>
<li>9.从企业团险详情—详情 进入的保险详情页面显示浮标；从具体的某个保险点击进入的保险详情不显示浮标</li>
<li>10.保险详情页：背景没有色块，按照效果图做</li>
<li>11.按钮感应范围不舒服：
顶端返回按钮感应范围太宽
试算页面加减按钮感应范围太窄</li>
<li>12.试算页面增加一人后，点击相应的列表应该在上面显示相应的信息，以便修改</li>
<li>13.申请记录去掉假数据，调用接口</li>
<li>14.申请记录点击后，背景色改浅一点</li>
<li>15.报险，提交报险信息后，提示“xxx小时候后会有答复”</li>
<li>16.租房详情：删除more按钮</li>
<li>17.租房的分享：分享失败</li>
<li>18.活动收藏：收藏或取消后不刷新</li>
<li>19.升档页面跟进设计稿修改 &ndash; <em>ing</em></li>
<li>20.试算页面开发 &ndash; <em>done</em></li>
<li>21.我的保障，申请记录列表，删除功能</li>
<li>22.我的保障，申请记录修改，使用试算页面逻辑</li>
<li>23.我的福利，保险购买记录</li>
</ul>

<h4 id="未做-4:84ed0d057c566f207df07d4dbf3355b4"><strong>未做：</strong></h4>

<ul>
<li>1.福米兑换场</li>
<li>2.签证：暂时没有资源</li>
<li>3.邀请码验证页面未做</li>
<li>4.福米兑换场首页功能实现 &ndash; <em>目前需求不是很明确，要明确一下</em></li>
<li>5.商品展示：商品列表和商品详情 &ndash; <em>ing :  ios:两天</em></li>
<li>6.购物车

<ul>
<li>6.1加入购物车</li>
<li>7.2加载购物车</li>
<li>7.3修改购物车</li>
<li>7.4删除购物车中的商品</li>
</ul></li>
<li>8.订单

<ul>
<li>8.1从购物车生成订单</li>
<li>8.2直接从商品生成订单</li>
<li>8.3订单加载</li>
<li>8.4订单修改</li>
<li>8.5取消订单</li>
</ul></li>
<li>9.评论

<ul>
<li>9.1发表评论</li>
<li>9.2查询评论</li>
</ul></li>
<li>10.支付（目前还没有考虑清楚，所以暂时这样分类）

<ul>
<li>10.1微信支付</li>
<li>10.2阿里支付</li>
<li>10.3福米支付</li>
</ul></li>
</ul>

					
				</div>
			</div>
			<div class="row">
				<div class="col-md-12">
					<hr>
				</div>
			</div>
		
	

        
            	
		
			<div class="row">
				
				<div class="col-md-offset-1 col-md-10">
					<h3><a href="http://eyestone.github.io/post/discuss-shippingAndCash/">物流和现金流</a></h3>
						<small><span class="label label-primary">
							
								Tue, Jun 21, 2016
							</span>&nbsp;in
							
								
								<a href="/categories/%E8%AE%A8%E8%AE%BA">讨论</a>
							 using tags
							
								
							<a href="/tags/%E7%89%A9%E6%B5%81">物流</a>
						
								 , 
							<a href="/tags/%E7%8E%B0%E9%87%91%E6%B5%81">现金流</a>
						
								 , 
							<a href="/tags/%E9%80%80%E6%AC%BE">退款</a>
						
					</small>
				</div>
			</div>
			<div class="row">
				<div class="col-md-offset-1 col-md-10">
					<br>
					
						

<h4 id="讨论结果:8aa69f015727393ae24eff79bcb0fb4c"><strong>讨论结果</strong></h4>

<h5 id="现金流:8aa69f015727393ae24eff79bcb0fb4c"><strong>现金流</strong></h5>

<ul>
<li>1.流向：

<ul>
<li>1.1.客户&ndash;&gt;来福：用户付款</li>
<li>1.2.来福&ndash;&gt;供应商：月结，如果发生退款的，在月结的时候一并扣除</li>
<li>1.3.来福&ndash;&gt;客户：用户申请退款给，在用户付款后2周内可以申请退款</li>
</ul></li>
<li>2.需要与供货商确认和达成的协议：

<ul>
<li>2.1.月结</li>
</ul></li>
</ul>

<h5 id="物流:8aa69f015727393ae24eff79bcb0fb4c"><strong>物流</strong></h5>

<ul>
<li>1.角色：

<ul>
<li>1.1.客户</li>
<li>1.2.来福</li>
<li>1.3.供应商</li>
<li>1.4.物流</li>
</ul></li>
<li>2.流程：

<ul>
<li>2.1.购买：用户下单&ndash;&gt;用户付款&ndash;&gt;来福收集订单&ndash;&gt;来福将订单提交给供应商&ndash;&gt;供应商发货&ndash;&gt;物流寄送&ndash;&gt;客户收货</li>
<li>2.2.退货1：用户提交退货申请&ndash;&gt;来福反馈退款信息给供应商&ndash;&gt;供应商和客户沟通&ndash;&gt;确认可退款&ndash;&gt;供应商告知来福&ndash;&gt;用户发货&ndash;&gt;物流配送&ndash;&gt;供应商收到货物&ndash;&gt;供应商通知来福&ndash;&gt;来福给用户打款</li>
<li>2.3.退货2：用户提交退货申请&ndash;&gt;来福和客户沟通&ndash;&gt;确认可以退款&ndash;&gt;来福告知供应商&ndash;&gt;用户发货&ndash;&gt;快递配送&ndash;&gt;供应商收到货物&ndash;&gt;供应商告知来福&ndash;&gt;来福打款给用户</li>
</ul></li>
<li>3.问题：

<ul>
<li>3.1.如果由供应商和客户沟通，需要保证供应商不透露任何自己公司的信息，以保证用户体验</li>
<li>3.2.如何保证物流控制和信息对称</li>
</ul></li>
<li>4.注意事项

<ul>
<li>4.1.供应商在发货以后应该将运单号和快递方式发送给来福</li>
<li>4.2.供应商在发货的时候应该打印一份包含来福，来福的订单号，买家在来福的用户名的单子放在快件中，并在单子上注明单子在退货时一并寄回，否则不能正常退款</li>
<li>4.3.用户在退货的时候，需要在app上填写运单号和快递方式</li>
<li>4.4.如果由供应商和客户沟通，需要保证供应商不透露任何自己公司的信息，以保证用户体验</li>
<li>4.5.需要供应商配合的问题，需要和供应商沟通达成一致，最好形成协议</li>
</ul></li>
</ul>

<h5 id="需要增加的功能:8aa69f015727393ae24eff79bcb0fb4c"><strong>需要增加的功能</strong></h5>

<ul>
<li>1.换货</li>
<li>2.运单号填写，可以扫描二维码</li>
</ul>

<h4 id="趣玩退货流程:8aa69f015727393ae24eff79bcb0fb4c"><strong>趣玩退货流程</strong></h4>

<ul>
<li>1.一般商品在20元一下已经无法二次销售的，可以和买家协商争取直接给予一定补偿来处理，这类你自己退了款的，需要记录好分销流水号和订单号，和处理情况，需要有买家的拍照为证，然后可以找负责分销的人士给退费。</li>
<li>2.商品在20元以上，确实因为质量问题需要退换货的，需退换的订单，请务必在退换货单子上注明客户的姓名、电话、退换原因与需求，否则可能会被延迟或无法处理如商品有质量问题，请于收货后7天内联系分销客服(7天之内无理由退换货)，核实无误后全额退/换，否则擅自寄回的物品将不予以处理（见易订货通知栏中提供的地址）；质量问题运费买家垫付。非质量问题，退换货运费均由买家承担（来回两个运费）！</li>
<li>3.客户需要退换货的情况，请先与我们联系，以确定该商品的处理方式（如：让客户寄给库房退换，或者赔偿一定费用让客户自行处理）。请确定进行退款操作后立即联系我们，以便我们能在第一时间得知该情况进行操作（尤其是刚付款就取消的订单）。</li>
</ul>

<h4 id="参与人:8aa69f015727393ae24eff79bcb0fb4c"><strong>参与人</strong></h4>

<ul>
<li>李艳</li>
<li>林欣灏</li>
<li>陆文金</li>
</ul>

<h4 id="记录人:8aa69f015727393ae24eff79bcb0fb4c"><strong>记录人</strong></h4>

<ul>
<li>陆文金</li>
</ul>

					
				</div>
			</div>
			<div class="row">
				<div class="col-md-12">
					<hr>
				</div>
			</div>
		
	

        
            	
		
			<div class="row">
				
				<div class="col-md-offset-1 col-md-10">
					<h3><a href="http://eyestone.github.io/post/discuss-shoppingCart/">购物车的设计</a></h3>
						<small><span class="label label-primary">
							
								Tue, Jun 14, 2016
							</span>&nbsp;in
							
								
								<a href="/categories/%E8%AE%A8%E8%AE%BA">讨论</a>
							 using tags
							
								
							<a href="/tags/%E8%B4%AD%E7%89%A9%E8%BD%A6">购物车</a>
						
					</small>
				</div>
			</div>
			<div class="row">
				<div class="col-md-offset-1 col-md-10">
					<br>
					
						<p><strong>讨论结果</strong></p>

<ul>
<li>1.点击大的编辑的时候，可以选中圆圈，批量删除</li>
<li>2.编辑的时候数量不能小于1</li>
</ul>

					
				</div>
			</div>
			<div class="row">
				<div class="col-md-12">
					<hr>
				</div>
			</div>
		
	

        
            	
		
			<div class="row">
				
				<div class="col-md-offset-1 col-md-10">
					<h3><a href="http://eyestone.github.io/post/discuss-oder/">订单和商品部分底层设计</a></h3>
						<small><span class="label label-primary">
							
								Mon, Jun 6, 2016
							</span>&nbsp;in
							
								
								<a href="/categories/%E8%AE%A8%E8%AE%BA">讨论</a>
							 using tags
							
								
							<a href="/tags/%E8%AE%A2%E5%8D%95">订单</a>
						
								 , 
							<a href="/tags/%E5%95%86%E5%93%81">商品</a>
						
					</small>
				</div>
			</div>
			<div class="row">
				<div class="col-md-offset-1 col-md-10">
					<br>
					
						

<h4 id="问题提出:040511b124b80c6ff6c159ebf8c53d4e">问题提出</h4>

<ul>
<li>如何从商品信息中获取order_process表中的标识位的相关信息</li>
<li>如何向用户展示详细的商品信息</li>
</ul>

<h4 id="讨论结果:040511b124b80c6ff6c159ebf8c53d4e">讨论结果</h4>

<ul>
<li>1.商品种类和卖法的总结如下图：</li>
</ul>

<p><img src="https://raw.githubusercontent.com/eyestone/eyestone.github.io/master/img/merchandise.png" width = "550"  alt="福米兑换场流程"       align=center /></p>

<ul>
<li>2.因为卖法涉及到价格计算以及一些业务流程的变化，而一个商品可能涉及到多种卖法，所以讲卖法单独拿出来作为一个表，其中要包括卖法相关的信息和价格。</li>
<li>3.目前订单部分为了照顾之前商品部分的内容，暂时不处理order_process表中的标识字段。</li>
<li>4.在第一阶段的order部分内容开发完成之后开始重构商品部分，同时完善订单部分内容。</li>
</ul>

<h4 id="参与人:040511b124b80c6ff6c159ebf8c53d4e">参与人</h4>

<ul>
<li>林欣灏</li>
<li>陆文金</li>
</ul>

<h4 id="记录:040511b124b80c6ff6c159ebf8c53d4e">记录</h4>

<ul>
<li>陆文金</li>
</ul>

					
				</div>
			</div>
			<div class="row">
				<div class="col-md-12">
					<hr>
				</div>
			</div>
		
	

        
            	
		
			<div class="row">
				
				<div class="col-md-offset-1 col-md-10">
					<h3><a href="http://eyestone.github.io/post/server-upgrade/">服务器代码的进化史</a></h3>
						<small><span class="label label-primary">
							
								Fri, Jun 3, 2016
							</span>&nbsp;in
							
								
								<a href="/categories/server">server</a>
							 using tags
							
								
							<a href="/tags/java">java</a>
						
								 , 
							<a href="/tags/spring">spring</a>
						
					</small>
				</div>
			</div>
			<div class="row">
				<div class="col-md-offset-1 col-md-10">
					<br>
					
						

<p>代码之美如同数学之美，好的代码通常是结构清晰，简单优雅的。
代码如同生命，需要时间的磨砺和进化，下面将对我们的服务器代码需进化的方向做系列分析。</p>

<h4 id="1-运行零配置:b1e14c958e519618679260e8b94cfa96"><strong>1. 运行零配置</strong></h4>

<p>一般服务器代码需要部署到容器之中才能正常运行，这不太符合拿来即用的原则。本地环境复杂化一向不是我推崇的方法，中国人自有最优秀的设计基因，比如中国的筷子就是比老外的刀叉更优秀的设计，所以复杂的代码系统不仅仅是功能设计，还需要优秀的配置管理。</p>

<p><strong>已搞定</strong></p>

<p>目前，通过对gradle脚本的改造，已经实现“运行零配置”的目标，方法为：</p>

<pre><code>cd welfare
gradle tomcatRunWar
</code></pre>

<p>你可以说，上面的代码还不完全是零配置，还需要安装gradle才能运行，当然不是：</p>

<pre><code>cd welfare
../gradlew tomcatRunWar 
</code></pre>

<p>gradlew 命令是在project根目录下的命令行，会自动在线下载gradle的运行环境，当然第一次执行时因为下载会比较费时。</p>

<p><strong>待解决的问题</strong></p>

<ul>
<li>代码中缓存系统memcached关闭后，tomcat启动时仍在不停的连接12345端口，这意味着代码中memcached的连接存在不能关闭的隐患</li>
</ul>

<hr />

<h4 id="2-session共享:b1e14c958e519618679260e8b94cfa96"><strong>2. session共享</strong></h4>

<p><strong>待解决</strong></p>

<p>session通常记录用户的登录信息，保持用户的登录状态。</p>

<p>现在的session系统采用spring默认的http session，只能自己用，不能分享给别人用，这种情况不利于未来微架构系统的分布式部署。</p>

<p><strong>解决方案</strong></p>

<p>采用spring-session框架, 将session由内存数据库redis接管。</p>

<hr />

<h4 id="3-紧耦合的session和权限管理:b1e14c958e519618679260e8b94cfa96"><strong>3. 紧耦合的session和权限管理</strong></h4>

<p><strong>待解决</strong></p>

<p>为实现标题中的功能，把代码写得到处都是，代价是不易维护，增加各种潜在隐患。</p>

<p><strong>解决方案</strong></p>

<p>采用切面技术将session和权限功能进行接管。</p>

<hr />

<h4 id="4-丑陋的memcached:b1e14c958e519618679260e8b94cfa96"><strong>4. 丑陋的memcached</strong></h4>

<p><strong>待解决</strong></p>

<p>先声明，其实memcached作为一个缓存技术，一点也不丑陋，这里的丑陋是指我们的使用它的代码丑陋。我们的使用方法是先写了一个数据库工具框架，然后在框架中嵌入memcached调用，要对那个表数据缓存，就把该表增加到insert，update，delete三个基本操作中。在很多年前，这样的设计是最优秀的方法之一，但时至今日，这样的设计不够灵活，现在增加一个缓存可以到方法上，简单到增加一个注解即可。</p>

<p>其二，对于缓存系统的使用，我更倾向于被广泛使用且兼容性好的。比如现在redis的被支持率明显高于memcached，很多框架代码缺省支持redis，如果我们想继续使用memcached，必须自行寻找各种支持库，麻烦费时。</p>

<p><strong>解决方案</strong></p>

<p>用redis代替memcached，但由于涉及到数据库处理层的修改，需要保持极度谨慎。</p>

<hr />

<h4 id="5-多环境零配置:b1e14c958e519618679260e8b94cfa96"><strong>5. 多环境零配置</strong></h4>

<p><strong>待解决</strong></p>

<p>现有的代码环境，简单分为开发环境和生产环境，而开发环境指向的域名为laifucard.net,生产环境为.com，在gradle编译时只需要通过snapshot和release参数就能区分产生不同环境的运行时war文件。</p>

<p>但，实际代码的实现方式却不优雅。仅仅是为了在不同编译参数时采用不同的域名，居然在service子项目中写了两个bean，同时还在两个xml文件中分别进行配置，想想就心塞。</p>

<p><strong>解决方案</strong></p>

<ul>
<li>将代码环境分为 开发环境 生产环境 和 本地开发环境，因为目前的开发环境主要适用于laifucard.net环境</li>
<li>环境变量写到文本配置文件中，目前主要包括域名配置和数据库配置信息</li>
<li>由程序自动选择性读取不同的环境变量，可采用spring的profile特性</li>
<li>gradle脚本增加一个编译选项，命名为local</li>
</ul>

<hr />

<h4 id="6-自动化测试:b1e14c958e519618679260e8b94cfa96"><strong>6. 自动化测试</strong></h4>

<p><strong>待解决</strong></p>

<p>目前代码并没有养成单元测试的习惯，服务器端的单元测试大量集中于对接口的测试，实现技术主要采用google的mokito框架。</p>

<p><strong>解决方案</strong></p>

<ul>
<li>针对已有接口写单元测试模板，供大家参考</li>
<li>gradle脚本增加集成测试编译选项，使其自动化</li>
</ul>

<hr />

<h4 id="7-代码检查:b1e14c958e519618679260e8b94cfa96"><strong>7. 代码检查</strong></h4>

<p><strong>待解决</strong></p>

<p>目前的代码检查方案是checkstyle,我原来已经做过检查。问题在于该工具的检查深度不够，我们需要更高级的工具帮我们来改善代码质量.</p>

<p><strong>解决方案</strong></p>

<ul>
<li>启用sonarqube技术，对源码做最全面的检查</li>
<li>根据检查结果，消除隐患，清除代码冗余</li>
</ul>

<hr />

<h4 id="8-异步消息系统:b1e14c958e519618679260e8b94cfa96"><strong>8. 异步消息系统</strong></h4>

<p><strong>待解决</strong></p>

<p>服务器系统中有短信通知、邮件通知、app通知等多种通知模式，在现阶段没什么用户的情况下问题不大，但当用户基数上去以后，最好将通知系统由异步消息系统接管，才能进一步提高服务器效率。</p>

<p>所谓异步消息系统就好比一个邮局，服务器程序只需要把通知内容交给邮局，就可以忙自己的其他事情了，剩下的事情都交给邮局自行处理。</p>

<p><strong>解决方案</strong></p>

<ul>
<li>服务器端部署消息代理系统</li>
<li>改造msg-push子项目，进行xml文件配置即可</li>
</ul>

<hr />

<p>(未完，待续)</p>

					
				</div>
			</div>
			<div class="row">
				<div class="col-md-12">
					<hr>
				</div>
			</div>
		
	

        
            	
		
			<div class="row">
				
				<div class="col-md-offset-1 col-md-10">
					<h3><a href="http://eyestone.github.io/post/common-terms/">术语说明</a></h3>
						<small><span class="label label-primary">
							
								Thu, Jun 2, 2016
							</span>&nbsp;in
							
								
								<a href="/categories/%E7%BA%A6%E5%AE%9A">约定</a>
							 using tags
							
								
							<a href="/tags/%E7%BA%A6%E5%AE%9A">约定</a>
						
								 , 
							<a href="/tags/%E6%9C%AF%E8%AF%AD">术语</a>
						
					</small>
				</div>
			</div>
			<div class="row">
				<div class="col-md-offset-1 col-md-10">
					<br>
					
						<table>
<thead>
<tr>
<th align="left">术语　　　　 　　　</th>
<th align="left">解释 　　　</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">订单进程</td>
<td align="left">指编程相关的流程控制，在订单系统中，涉及到springWebFlow的流程</td>
</tr>

<tr>
<td align="left">订单过程</td>
<td align="left">指一个订单从选购商品到最后成交的用户和系统交互的过程。目前整理的过程包括：选购商品-&gt;加入购物车-&gt;确认订单-&gt;支付订单-&gt;发货-&gt;物流-&gt;签收</td>
</tr>

<tr>
<td align="left">付款码</td>
<td align="left">用于表明用户已购买身份的码。比如用户在我们平台上购买了一个健身卡，平台给用户分配一个付款码，用户凭此付款码就可以到相关的健身房健身。</td>
</tr>

<tr>
<td align="left">参与码</td>
<td align="left">对于一些付费或者有限制条件的活动，用户报名后平台给用户分配一个参与码，用户凭这个码可以参与活动</td>
</tr>

<tr>
<td align="left">充福米</td>
<td align="left">用各种方式为用户账户充入福米</td>
</tr>

<tr>
<td align="left">充值</td>
<td align="left">为各种卡等虚拟商品充值，可以使用福米、支付宝等各种方式</td>
</tr>

<tr>
<td align="left">福米充值</td>
<td align="left">这显然是个坑，概念太模糊，不建议使用</td>
</tr>
</tbody>
</table>

<p>　　</p>

<p><strong>记录</strong></p>

<ul>
<li>陆文金</li>
</ul>

					
				</div>
			</div>
			<div class="row">
				<div class="col-md-12">
					<hr>
				</div>
			</div>
		
	

        
            	
		
			<div class="row">
				
				<div class="col-md-offset-1 col-md-10">
					<h3><a href="http://eyestone.github.io/post/discuss-fumiCashing/">福米兑换场流程和相关接口的讨论</a></h3>
						<small><span class="label label-primary">
							
								Tue, May 31, 2016
							</span>&nbsp;in
							
								
								<a href="/categories/%E8%AE%A8%E8%AE%BA">讨论</a>
							 using tags
							
								
							<a href="/tags/%E7%A6%8F%E7%B1%B3%E5%85%91%E6%8D%A2%E5%9C%BA">福米兑换场</a>
						
								 , 
							<a href="/tags/%E8%AE%A2%E5%8D%95">订单</a>
						
					</small>
				</div>
			</div>
			<div class="row">
				<div class="col-md-offset-1 col-md-10">
					<br>
					
						

<h4 id="问题提出:35f38fbbf3cae5068faaee2eb90e91ea">问题提出</h4>

<ul>
<li>对于即将开展的工作内容的常规讨论</li>
</ul>

<h4 id="讨论结果:35f38fbbf3cae5068faaee2eb90e91ea">讨论结果</h4>

<ul>
<li>1.流程图如下，图中备注为需要用到的接口，打钩的表示已经实现的</li>
</ul>

<p><img src="https://raw.githubusercontent.com/eyestone/eyestone.github.io/master/img/fumiExchangeFlowChart.png" width = "550"  alt="福米兑换场流程" align=center /></p>

<ul>
<li>2.在旧版本的代码中实现相关接口</li>
<li>3.使用spring web flow技术实现订单部分内容</li>
<li>4.对数据库表进行了相应的修改</li>

<li><p>5.order_status表中增加1个状态：已处理，表示我们平台已经将信息提交到供应商。</p>

<ul>
<li>name　　　　value　　　　remark<br /></li>
<li>已删除　　　　0<br /></li>
<li>未付款　　　　1</li>
<li>已付款　　　　2</li>
<li>已取消　　　　3</li>
<li>已消费　　　　4</li>
<li>申请退款中　　5</li>
<li>已退款　　　　6</li>
<li>已评价　　　　7</li>
<li>已处理　　　　8　　　　　　表示我们平台已经将订单通知到供应商，可能需要改编号</li>
</ul></li>

<li><p>6.order_v2表中增加一个exception_code字段，用于记录异常信息。</p>

<ul>
<li>name　　　　value　　　　remark</li>
<li>正常　　　　　0</li>
<li>订单缺货　　　1</li>
</ul></li>

<li><p>7.订单过程，因为目前没有办法监控供应商和物流，所以对于我们来说，用户付款就认为交易完成。</p></li>
</ul>

<h4 id="数据库相关:35f38fbbf3cae5068faaee2eb90e91ea">数据库相关</h4>

<ul>
<li>1.购物车：bills，charge_record，collection，service_invoke_record</li>
<li>2.订单：order_pay(暂时不用)，order_detail，link_type，order_v2(在用)，order(旧表，不建议用)，order_status，order_ticket_link，user_delivery_info</li>
<li>3.merchandise_off_price(不建议用，在相关的表中使用tags字段作为另一个价格)，merchandise_specification，merchandise_type，merchandise_qualification，merchandise</li>
</ul>

<h4 id="todo:35f38fbbf3cae5068faaee2eb90e91ea">TODO</h4>

<ul>
<li>1.增加收货地址表，设置：userUuid，address，consignee，default，modifyTime字段</li>
<li>2.实现相关接口</li>
</ul>

<h4 id="问题:35f38fbbf3cae5068faaee2eb90e91ea">问题</h4>

<ul>
<li>1.考虑多商品订单如果往新的表（分子表）中存放，会出现什么问题？</li>
</ul>

<h4 id="参与人:35f38fbbf3cae5068faaee2eb90e91ea">参与人</h4>

<ul>
<li>林欣灏</li>
<li>陆文金</li>
</ul>

<h4 id="记录:35f38fbbf3cae5068faaee2eb90e91ea">记录</h4>

<ul>
<li>陆文金</li>
</ul>

					
				</div>
			</div>
			<div class="row">
				<div class="col-md-12">
					<hr>
				</div>
			</div>
		
	

        
            	
		
			<div class="row">
				
				<div class="col-md-offset-1 col-md-10">
					<h3><a href="http://eyestone.github.io/post/hugo-issues/">关于hugo中markdown格式的兼容性问题</a></h3>
						<small><span class="label label-primary">
							
								Tue, May 31, 2016
							</span>&nbsp;in
							
								
								<a href="/categories/hugo">hugo</a>
							 using tags
							
								
							<a href="/tags/hugo">hugo</a>
						
								 , 
							<a href="/tags/markdown">markdown</a>
						
					</small>
				</div>
			</div>
			<div class="row">
				<div class="col-md-offset-1 col-md-10">
					<br>
					
						<p>目前hugo并不兼容markdown的高级格式功能，比如todo list和流程图。</p>

<p>经检查源码，发现是markdown的解码问题，原理为通过识别markdown标识，解析成对应html格式，而是流程图功能，为markdown扩展功能，用到了html5的矢量图特性。这类的功能增强要么我们自己扩展，要么坐等官方更新。</p>

<p>仅作记录，空了继续补充。</p>

					
				</div>
			</div>
			<div class="row">
				<div class="col-md-12">
					<hr>
				</div>
			</div>
		
	

        
            	
		
			<div class="row">
				
				<div class="col-md-offset-1 col-md-10">
					<h3><a href="http://eyestone.github.io/post/tutorial-UseBlogOnWindows/">在windows下使用hugo写博客</a></h3>
						<small><span class="label label-primary">
							
								Wed, May 25, 2016
							</span>&nbsp;in
							
								
								<a href="/categories/%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E">使用说明</a>
							
								 , 
								<a href="/categories/windows">windows</a>
							 using tags
							
								
							<a href="/tags/blog">blog</a>
						
								 , 
							<a href="/tags/windows">windows</a>
						
					</small>
				</div>
			</div>
			<div class="row">
				<div class="col-md-offset-1 col-md-10">
					<br>
					
						<ul>
<li>运行框（开始按钮旁边的小框框）输入cmd，回车打开命令行工具</li>
<li>输入cd D: 回车  这个是跳转到相关的磁盘，如果是E盘，就输入E:</li>
<li>输入 D: 回车  这个是切换到相应的盘</li>
<li>输入 cd dir 回车  dir为要进入的目录，比如你的blog目录放在D:/blog就直接输入 cd blog</li>
<li>新建文件 hugo new post/filename.md 这样就会在blog/content/post目录下创建一个filename.md文件</li>
<li>用文本编辑器打开要编辑的文件进行编辑保存</li>
<li>在命令行输入show.cmd，然后在浏览器输入localhost:1313即可查看本地的文档</li>
<li>使用deploy.cmd命令，可以将本地文档同步到服务器</li>
</ul>

					
				</div>
			</div>
			<div class="row">
				<div class="col-md-12">
					<hr>
				</div>
			</div>
		
	

        
            	
		
			<div class="row">
				
				<div class="col-md-offset-1 col-md-10">
					<h3><a href="http://eyestone.github.io/post/discuss-shengdang3/">关于升档页面有未保存的编辑数据时的提交的讨论</a></h3>
						<small><span class="label label-primary">
							
								Tue, May 24, 2016
							</span>&nbsp;in
							
								
								<a href="/categories/%E8%AE%A8%E8%AE%BA">讨论</a>
							 using tags
							
								
							<a href="/tags/%E5%8D%87%E6%A1%A3">升档</a>
						
								 , 
							<a href="/tags/%E7%BC%96%E8%BE%91">编辑</a>
						
								 , 
							<a href="/tags/%E6%8F%90%E7%A4%BA">提示</a>
						
					</small>
				</div>
			</div>
			<div class="row">
				<div class="col-md-offset-1 col-md-10">
					<br>
					
						<p><strong>问题提出</strong></p>

<ul>
<li>按照之前的设计，在点击添加人的时候会默认将当前编辑的人的信息保存</li>
<li>可是“我”并不想保存这个人的信息</li>
</ul>

<p><strong>讨论结果</strong></p>

<ul>
<li>1.人名右边的点击按钮只作为展开人名列表之用</li>
<li>2.下面的“添加一人”按钮用做保存已编辑的信息</li>
<li>3.修改已保存的列表中的信息时，如果有未保存的人的信息，提示“放弃|保存”</li>
<li>4.点击“提交”按钮时，如果有未保存的人的信息，提示“放弃|提交”</li>
<li>5.如果选择放弃即将未保存的信息忽略，其他信息照常处理</li>
</ul>

<p><strong>参与人</strong></p>

<ul>
<li>李艳</li>
<li>陆文金</li>
</ul>

<p><strong>记录</strong></p>

<ul>
<li>陆文金</li>
</ul>

					
				</div>
			</div>
			<div class="row">
				<div class="col-md-12">
					<hr>
				</div>
			</div>
		
	

        
	</div>
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="text-center">
                    
    
    <ul class="pagination">
        
        <li>
            <a href="/" aria-label="First"><span aria-hidden="true">&laquo;&laquo;</span></a>
        </li>
        
        <li
        class="disabled">
        <a href="" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
        </li>
        
        <li
        class="active"><a href="/">1</a></li>
        
        <li
        ><a href="/page/2/">2</a></li>
        
        <li
        >
        <a href="/page/2/" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
        </li>
        
        <li>
            <a href="/page/2/" aria-label="Last"><span aria-hidden="true">&raquo;&raquo;</span></a>
        </li>
        
    </ul>
    
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <hr>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row col-md-12">
            <footer>
                <div class="pull-left">
                    <p>
                        &copy;  ~ Powered By <a href="http://hugo.spf13.com">Hugo</a> - version: 0.15 ~ <a href="http://eyestone.github.io/license">License</a>
                    </p>
                </div>

                
                <div class="pull-right">
                    
                    
                    
                    
                        <a href="https://github.com/eyestone" target="_blank">
                        <i class="fa fa-github-square fa-2x"></i></a>
                    
                    
                    
                    
                        <a href="http://eyestone.github.io/index.xml" target="_blank">
                        <i class="fa fa-rss-square fa-2x"></i></a>
                    
                </div>
            </footer>
        </div>
    </div>

    
    </body>
</html>

